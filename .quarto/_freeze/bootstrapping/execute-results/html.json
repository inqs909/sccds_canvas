{
  "hash": "89036270fa37440513e74a30645ce426",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"The Bootstrap Method\"\ndate-modified: \"2024-10-14\"\n---\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(palmerpenguins)\n\ntheme_set(theme_bw())\ntheme_update(axis.title = element_text(size = 24))\n\nshuffle <- function(x){\n  n <- length(x)\n  return(sample(x, n))\n}\n\npenguins <- penguins |> drop_na() \n```\n:::\n\n\n\n\nLet $X_1, \\ldots, X_n$ come from a distribution $F(\\theta)$ and let $T$ be an estimator for $\\theta$\n\nThe Boostrap Method is an approach that can construct the sampling distribution of several estimators, not all estimators, without imposing a mathematical model on the data. The idea is that the sample $X_1, \\ldots, X_n$ is generated from a distribution function called $F(\\theta)$. If the sample is large enough, then the empirical distribution function $\\hat F$ should begin to look like the true distribution function $F$ so long as the sample is large enough. This implies the sample can be assumed to contain all the information of $F$. Therefore, if we resample from our sample, with replacement, we are then sampling from our empirical distribution $\\hat F$, which looks really close to the true $F$. \n\n\nThe new resampled data, $B_1$, is similar to taking a random sample from $F$. The resample $B$ will produce a value for an estimator, called $T_1$. Since the estimator can change values due to the values of the  \n\n\n## Empirical Distribution Function\n\nThe empirical distribution function is designed to estimate a random variable's distribution function. For an observed sample $\\{x_i\\}^n_{i=1}$, the empirical distribution function is\n\n$$\nF_n(x) \\left\\{\\begin{array}{cc}\n0, & x < x_{(1)} \\\\\n\\frac{i}{n},& x_{(i)} \\leq x <x_{(i+1)},\\ i = 1,\\ldots,n-1\\\\\n1,& x_{(n)}\\leq x\n\\end{array}\n\\right.\n$$\n\nwhere $x_{(1)}, \\ldots, x_{(n)}$ are the ordered sample.\n\n### Sampling an unknown $F$\n\nThe idea behind bootstrapping is that the data comes from a distribution $F$ with unknown parameters.\n\nUsing the sample, we can get parameters that explain a parameteric distribution or the emperical distribution for a nonparameteric approach. \n\n## The Bootstrap Method\n\nThe Bootstrap Method utilizes the sample to describe the target distribution function to construct a sampling mechanism of the target distribution.\n\nThis method will allow us to construct a new sample that targets the distribution.\n\nWe can then construct the sampling distribution of a statistic based on the data.\n\n### Standard Error\n\nThe bootstrap-based standard error of a test statistic is shown to provide an unbiased estimate of the true standard error. \n\n### Limitation to Boostrap Methods\n\nThe assumption is that the data provides a good estimate of the distribution function.\n\nIf the data set is small, it may not contain enough information to accurately describe the distribution.\n\n\n## Parameteric Bootstrap\n\nParametric bootstrap methods are statistical techniques used to estimate the sampling distribution of an estimator or test statistic by resampling with a model-based approach. This method assumes that the data follow a known probability distribution, and utilizes the estimated statistics as the parameters for the distribution function to construct the sampling distribution.\n\n### Parameteric Bootstrap Algorithm\n\n1. Estimate the Parameters: Fit a parametric model to the observed data and estimate the parameters of the model. \n\n2. Generate Bootstrap Samples: Using the estimated parameters, generate a large number of new data sets (bootstrap samples) from the fitted model. These samples are simulated data sets that mimic the original data but are generated from the parametric model.\n\n3. Compute the Statistic of Interest: For each bootstrap sample, calculate the statistic of interest (e.g., the mean, variance, regression coefficients, etc.).\n\n4. Construct the Sampling Distribution: Use the calculated statistics from all the bootstrap samples to construct an empirical sampling distribution. \n\n5. Estimate Confidence Intervals: Use the empirical sampling distribution to estimate confidence intervals.\n\n### Example\n\nUse a parameteric bootstrap model to determine the standard errors of the mean body mass of each penguin species.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> group_by(species) |> \n  summarise(mean = mean(body_mass_g),\n            se = sd(body_mass_g) / sqrt(n()))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  species    mean    se\n  <fct>     <dbl> <dbl>\n1 Adelie    3706.  38.0\n2 Chinstrap 3733.  46.6\n3 Gentoo    5092.  46.0\n```\n\n\n:::\n:::\n\n\n\nAnswer:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmeans <- penguins$body_mass_g |> tapply(penguins$species, mean)\nnns <- penguins$body_mass_g |> tapply(penguins$species, length)\nsds <- penguins$body_mass_g |> tapply(penguins$species, sd)\nAmeans <- numeric(10000)\nCmeans <- numeric(10000)\nGmeans <- numeric(10000)\nfor (i in 1:10000){\n  Ameans[i] <- rnorm(nns[1], mean = means[1], sd = sds[1]) |> mean()\n  Cmeans[i] <- rnorm(nns[2], mean = means[2], sd = sds[2]) |> mean()\n  Gmeans[i] <- rnorm(nns[3], mean = means[3], sd = sds[3]) |> mean()\n}\n```\n:::\n\n\n\n## Nonparameteric Bootsrap\n\nThe nonparameteric approach assumes that distribution function of the data does not follow a common distribution function. Therefore, the data itself will be contain all the information needed to construct the sampling distribution.\n\nThis requires sampling with replacement.\n\n### Nonparameteric Bootstrap Algorithm\n\n1.  Draw a sample $X*$ of size $n$ with replacement from the original data $X$.\n    1.  $n$ is the size of the data\n2.  Compute the bootstrap replicate statistic $T* = g(X*)$, where $g(\\cdot)$ is the function that computes the statistic of interest.\n3.  Repeat steps 1-2 $B$ times to obtain $B$ bootstrap replicates ${T*_1, T*_2, ..., T*_B}$.\n4.  The computed statistics from $B$ samples are the empirical bootstrap distribution of the statistic, $g(X)$.\n5.  Calculate the bootstrap standard error of the statistic, $se_b(g(X))$, as the standard deviation of the bootstrap replicates.\n6.  Calculate the bootstrap confidence interval for the statistic, $CI(g(X))$, with the $\\alpha$ and $(1-\\alpha)%$ percentiles of the bootstrap replicates, where $\\alpha$ is the desired level of significance.\n\n### Example\n\nFitting the following model:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\nlibrary(tidyverse)\npenguins <- penguins |> drop_na()\npenguins |> lm(body_mass_g ~ flipper_length_mm + bill_length_mm + bill_depth_mm,\n               data = _)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = body_mass_g ~ flipper_length_mm + bill_length_mm + \n    bill_depth_mm, data = penguins)\n\nCoefficients:\n      (Intercept)  flipper_length_mm     bill_length_mm      bill_depth_mm  \n        -6445.476             50.762              3.293             17.836  \n```\n\n\n:::\n:::\n\n\n\nObtain the Bootstrap-based Standard Errors for the regression coefficients. Use $B=1000$ bootstrap samples.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}